# PostgreSQL Client Authentication Configuration File
# This file controls: which hosts are allowed to connect, how clients
# are authenticated, which PostgreSQL user names they can use, which
# databases they can access.

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# "local" is for Unix domain socket connections only (inside container)
# No password required when connecting locally inside the container
local   all             postgres                                trust
local   all             rollplay                                trust

# IPv4 connections from Docker network - require password
# Docker default bridge network is typically 172.17.0.0/16
# Docker Compose creates custom networks typically in 172.18.0.0/16 to 172.31.0.0/16
host    rollplay        postgres        172.16.0.0/12           md5
host    rollplay        rollplay        172.16.0.0/12           md5

# Allow connections from the specific Docker Compose network with password
host    rollplay        postgres        rollplay_default        md5
host    rollplay        rollplay        rollplay_default        md5

# SECURITY: Explicitly deny all other connections
# This ensures no external connections can be made
host    all             all             0.0.0.0/0               reject
host    all             all             ::/0                    reject

# Note: The order matters - PostgreSQL uses the first matching rule